# GORewrite ユーザーマニュアル

GORewrite は、囲碁の棋譜編集・検討・印刷・エクスポートに特化したWebアプリケーション（およびChrome拡張機能）です。SGF形式のサポート、強力な分岐機能、そして美しい印刷・画像出力機能を備えています。

## 目次

1. [主な機能](#主な機能)
2. [基本操作](#基本操作)
   - [盤面操作](#盤面操作)
   - [ツールバーとモード](#ツールバーとモード)
3. [ショートカットキー](#ショートカットキー)
4. [SGFの読み込みと保存](#sgfの読み込みと保存)
5. [印刷機能](#印刷機能)
6. [画像エクスポート](#画像エクスポート)

---

## 主な機能

- **SGF完全対応**: 分岐（Branch）を含むSGFファイルの読み込み・保存・編集が可能です。
- **美しい盤面描画**: リアルな碁石と木目を再現したUI（モノクロモードも搭載）。
- **印刷機能**: プロ仕様の棋譜印刷が可能。ヘッダー・フッターのカスタマイズ、総譜・部分図の出力に対応。
- **画像エクスポート**: 範囲選択による画像化、クリップボードへのコピー、透過PNG/SVG出力。
- **検討モード**: 自由に石を置いたり、手順を戻して検討することができます。

---

## 基本操作

### 盤面操作

- **石を打つ**: マウス左クリックで交点に石を打ちます。手数が自動的に進みます。
- **手番の表示**: カーソル位置に次に打たれる石が半透明（ゴースト）で表示されます。
- **手戻し・手進み**: 
  - マウスホイール、またはキーボードの矢印キー（`←` / `→`）で手数を移動できます。
  - 右クリックで「最後の手を取り消し（Undo）」が可能です（通常モード時）。
- **パス (Pass)**: ツールバーの「✋」ボタンをクリックすることで、パス（1回休み）を行えます。手数が進み、手番が交代します。SGFにもパスとして記録されます。

### ツールバーとモード

画面上部のツールバーで機能を切り替えます。

- **New (新規作成)**: 盤面をクリアし、新しい棋譜を作成します。(**Alt+N**)
- **Open (開く)**: ローカルのSGFファイルを読み込みます。(**Ctrl+O**)
- **Save (保存)**: 現在の棋譜をSGFファイルとして保存（上書き保存）します。
- **Save As (名前を付けて保存)**: 新しいファイル名で保存します。(**Ctrl+S**)
- **Print (印刷)**: 印刷設定画面を開きます。(**Ctrl+P**)
- **Export**: 画像としてエクスポートします。(**Ctrl+F** でコピー)

---

## ショートカットキー

効率的な操作のために多くのショートカットキーが用意されています。

| キー操作 | 機能 | 備考 |
|---|---|---|
| `←` / `→` | 1手戻る / 進む | |
| `Ctrl` + `Z` | 元に戻す (Undo) | 最後の手を削除 |
| `Ctrl` + `Y` | やり直し (Redo) | 手を進める |
| `Ctrl` + `S` | SGF保存 | |
| `Ctrl` + `O` | SGFを開く | |
| `Ctrl` + `F` | 画像コピー | 選択範囲があればその範囲、なければ全体 |
| `Ctrl` + `C` | SGFコピー | クリップボードにSGFテキストをコピー |
| `Ctrl` + `V` | SGF貼り付け | クリップボードからSGFを読み込み |
| `Ctrl` + `P` | 印刷 | 印刷ダイアログ表示 |
| `Alt` + `N` | 新規作成 (New) | 盤面クリア |
| `Ctrl` + `S` | 名前を付けて保存 | 「別名保存」ボタンと同じ |
| `Delete` | 手の削除 | 現在のノードを削除 |
| `Escape` | キャンセル | 選択モードやヘルプの解除 |

---

## SGFの読み込みと保存

### 読み込み (Open)
- ツールバーの **「📂 (Open)」ボタン** をクリックし、ローカルファイルからSGFを読み込みます。（`Ctrl+O` も使用可能）
- 読み込み時、SGF内のすべての分岐（Branch）構造が解析され、操作で辿ることができます。

### 保存 (Save)
- ツールバーの **「💾 (Save)」ボタン** で、現在の棋譜をSGF形式で上書き保存します。（ショートカット `Ctrl+S` は「名前を付けて保存」になります）
- ツールバーの **「📋 (Copy SGF)」ボタン**（または `Ctrl+C`）を使うと、ファイルを作成せずにSGFテキストをクリップボードにコピーできます。

---

## 印刷機能

ツールバーの **「🖨️ (Print)」ボタン** からアクセスします。（ショートカット: `Ctrl+P`）

### 主な設定項目
- **用紙サイズ**: A4 / B5 等を選択可能。
- **譜割り**: 「総譜（Whole File）」または「手順図（Figure - 50手、100手ごとなど）」を選択可能。
- **ヘッダー/フッター**: カスタムテキストを設定できます。以下の変数が使用可能です。
  - `%BLACK%`: 黒番の対局者名
  - `%WHITE%`: 白番の対局者名
  - `%DATE%`: 対局日
  - `%RESULT%`: 結果
  - `%NUM%`: 現在の手数
- **詳細設定**: 黒番/白番のレイアウト調整、フォントサイズ変更など。

---

## 画像エクスポート

ブログやSNS、書籍作成用に盤面の画像を綺麗に出力できます。

### 全体エクスポート
- ツールバーの **「📷 (Export)」ボタン** をクリックすると、現在の盤面全体を画像化して保存します。（`Ctrl+F` でクリップボードにコピーも可能）

### 部分図エクスポート
1. マウスで盤面をドラッグして範囲を選択します（青い枠が表示されます）。
2. 範囲が決まったら **「📷 (Export)」ボタン** をクリック（または `Ctrl+F`）すると、その範囲だけが画像として保存・コピーされます。
3. **Leave 5 Moves**: エクスポート設定で、最新の5手だけ数字を表示し、それ以前を数字なし（または消去）にするなどの調整が可能です。

### 形式
- **PNG**: 一般的な画像形式。
- **SVG**: ベクター形式。拡大しても劣化せず、DTPソフトでの利用に最適です。
